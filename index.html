<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS 58mm - Chicken Noodle Full Opt</title>
    <style>
        body { font-family: 'Tahoma', sans-serif; background-color: #f0f4f8; padding: 15px; display: flex; justify-content: center; }
        .pos-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); width: 100%; max-width: 380px; }
        .input-row { margin-bottom: 12px; }
        label { display: block; font-size: 14px; color: #666; margin-bottom: 4px; }
        input { width: 100%; padding: 10px; box-sizing: border-box; border: 2px solid #edf2f7; border-radius: 8px; font-size: 18px; font-weight: bold; }
        input:focus { border-color: #4299e1; outline: none; }
        
        .change-box { background: #ebf8ff; padding: 10px; border-radius: 8px; text-align: center; margin-top: 10px; }
        .change-label { color: #2b6cb0; font-size: 14px; }
        .change-amount { font-size: 28px; font-weight: bold; color: #2c5282; }

        .btn-print { width: 100%; padding: 16px; background: #38a169; color: white; border: none; border-radius: 10px; font-size: 20px; font-weight: bold; cursor: pointer; margin-top: 15px; }
        .btn-print:active { background: #2f855a; transform: translateY(2px); }
        .q-display { text-align: center; font-size: 45px; font-weight: bold; color: #e53e3e; margin: 5px 0; }

        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à 58mm */
        #receipt-section { 
            display: none; 
            width: 48mm; 
            font-family: 'Courier New', monospace; 
            font-size: 12px;
            color: #000;
        }
        .text-center { text-align: center; }
        .line { border-top: 1px dotted #000; margin: 4px 0; }
        .big-q { font-size: 26px; font-weight: bold; border: 2px solid #000; padding: 4px 12px; margin: 5px 0; display: inline-block; }
        .flex { display: flex; justify-content: space-between; margin: 2px 0; }

        @media print {
            @page { margin: 0; }
            body { margin: 0; padding: 0; }
            .pos-card { display: none; }
            #receipt-section { display: block; }
        }
    </style>
</head>
<body>

<div class="pos-card">
    <h3 style="text-align:center; margin:0; color:#d32f2f;">üçú POS ‡∏´‡∏°‡∏µ‡πà‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å</h3>
    <div class="q-display"><span id="q-next">001</span></div>
    
    <div class="input-row">
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ä‡∏∏‡∏î‡∏•‡∏∞ 50.-)</label>
        <input type="number" id="qty" value="1" min="1" oninput="calculateAll()">
    </div>
    <div class="input-row">
        <label>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (‡∏ö‡∏≤‡∏ó)</label>
        <input type="number" id="discount" value="0" min="0" oninput="calculateAll()">
    </div>
    <div class="input-row">
        <label style="color:#2d3748; font-weight:bold;">‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
        <input type="number" id="cash-received" placeholder="0" oninput="calculateAll()" style="background:#fffaf0; border-color:#fbd38d;">
    </div>

    <div class="change-box">
        <div class="change-label">‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</div>
        <div class="change-amount"><span id="change-display">0</span>.-</div>
    </div>

    <h3 style="text-align:center; margin: 15px 0 5px 0;">‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: <span id="total-text" style="color:#e53e3e;">50</span>.-</h3>
    
    <button class="btn-print" onclick="processOrder()">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à & ‡∏£‡∏±‡∏ô‡∏Ñ‡∏¥‡∏ß</button>
    <p style="text-align:center;"><button onclick="resetQ()" style="background:none; border:none; color:#a0aec0; text-decoration:underline; cursor:pointer; font-size:12px;">Reset Queue 001</button></p>
</div>

<div id="receipt-section">
    <div class="text-center">
        <strong>‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</strong><br>
        <span>‡∏£‡πâ‡∏≤‡∏ô‡∏´‡∏°‡∏µ‡πà‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å‡πÅ‡∏™‡∏ô‡∏≠‡∏£‡πà‡∏≠‡∏¢</span><br>
        <div class="big-q" id="r-q">001</div><br>
        <span id="r-time" style="font-size: 10px;"></span>
    </div>
    
    <div class="line"></div>
    <div class="flex">
        <span>‡∏´‡∏°‡∏µ‡πà‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å x <span id="r-qty">1</span></span>
        <span id="r-subtotal">50</span>
    </div>
    <div class="flex">
        <span>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</span>
        <span id="r-discount">-0</span>
    </div>
    <div class="line"></div>
    
    <div class="flex" style="font-weight:bold;">
        <span>‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span>
        <span id="r-total">50</span>
    </div>
    <div class="flex">
        <span>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</span>
        <span id="r-cash">0</span>
    </div>
    <div class="flex">
        <span>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</span>
        <span id="r-change">0</span>
    </div>
    <div class="line"></div>
    
    <div class="text-center" style="font-size: 10px; margin-top: 5px;">
        ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö
    </div>
</div>

<script>
    let q = parseInt(localStorage.getItem('q_val')) || 1;
    document.getElementById('q-next').innerText = q.toString().padStart(3, '0');

    function calculateAll() {
        let qty = parseFloat(document.getElementById('qty').value) || 0;
        let disc = parseFloat(document.getElementById('discount').value) || 0;
        let cash = parseFloat(document.getElementById('cash-received').value) || 0;
        
        let total = (qty * 50) - disc;
        if (total < 0) total = 0;
        
        let change = cash - total;
        if (change < 0 || isNaN(change)) change = 0;

        document.getElementById('total-text').innerText = total.toLocaleString();
        document.getElementById('change-display').innerText = change.toLocaleString();
        
        return { qty, disc, total, cash, change };
    }

    function processOrder() {
        let data = calculateAll();
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏≠‡πÑ‡∏´‡∏°
        if (parseFloat(document.getElementById('cash-received').value) < data.total) {
            alert("‡∏¢‡∏≠‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏Ñ‡∏£‡∏±‡∏ö!");
            return;
        }

        let time = new Date().toLocaleString('th-TH', { hour12: false });

        // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
        document.getElementById('r-q').innerText = q.toString().padStart(3, '0');
        document.getElementById('r-time').innerText = time;
        document.getElementById('r-qty').innerText = data.qty;
        document.getElementById('r-subtotal').innerText = (data.qty * 50).toLocaleString();
        document.getElementById('r-discount').innerText = "-" + data.disc.toLocaleString();
        document.getElementById('r-total').innerText = data.total.toLocaleString();
        document.getElementById('r-cash').innerText = data.cash.toLocaleString();
        document.getElementById('r-change').innerText = data.change.toLocaleString();

        // ‡∏û‡∏¥‡∏°‡∏û‡πå
        window.print();

        // ‡∏£‡∏±‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏ï‡πà‡∏≠
        q++;
        localStorage.setItem('q_val', q);
        document.getElementById('q-next').innerText = q.toString().padStart(3, '0');
        
        // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
        document.getElementById('qty').value = 1;
        document.getElementById('discount').value = 0;
        document.getElementById('cash-received').value = "";
        calculateAll();
    }

    function resetQ() {
        if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏ß‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà 001?")) {
            q = 1;
            localStorage.setItem('q_val', q);
            document.getElementById('q-next').innerText = "001";
        }
    }
</script>

</body>
</html>
